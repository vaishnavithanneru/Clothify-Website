<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Clothify - Premium Clothing Store</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Inter',sans-serif;background:#f1f3f6}
    .header{background:#131921;color:white;padding:12px 20px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:1000}
    .logo{font-size:28px;font-weight:900}
    .cart-btn{background:#f0c14b;color:#111;padding:10px 25px;border-radius:30px;font-weight:bold;cursor:pointer}
    .hero{background:linear-gradient(rgba(0,0,0,0.7),rgba(0,0,0,0.7)),url('https://images.unsplash.com/photo-1441986300917-64672809604f');background-size:cover;color:white;text-align:center;padding:140px 20px}
    .hero h1{font-size:60px}
    .products{max-width:1500px;margin:50px auto;padding:0 20px;display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:30px}
    .card{background:white;border-radius:15px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.15);transition:0.3s}
    .card:hover{transform:translateY(-15px);box-shadow:0 20px 40px rgba(0,0,0,0.2)}
    .card img{width:100%;height:380px;object-fit:cover}
    .info{padding:25px}
    .info h3{font-size:20px;margin-bottom:10px}
    .price{font-size:32px;font-weight:900;color:#B12704;margin:15px 0}
    .add-btn{width:100%;padding:16px;background:#ffd814;border:none;border-radius:10px;font-weight:bold;font-size:18px;cursor:pointer}
    .add-btn:hover{background:#f7ca00}
    .cart-page{max-width:1000px;margin:60px auto;background:white;padding:40px;border-radius:15px;box-shadow:0 15px 40px rgba(0,0,0,0.1)}
    .checkout-btn{width:100%;padding:20px;background:#ff9900;color:white;border:none;border-radius:12px;font-size:22px;font-weight:bold;cursor:pointer;margin-top:30px}
    .success{text-align:center;padding:150px 20px;background:#d4edda;color:#155724}
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const App = () => {
      const [products, setProducts] = useState([]);
      const [cart, setCart] = useState([]);
      const [page, setPage] = useState('home');

      useEffect(() => {
        axios.get('http://localhost:5000/api/products')
          .then(res => setProducts(res.data.products || res.data))
          .catch(() => {
            // Fallback: show products directly from root if API route not ready
            axios.get('http://localhost:5000')
              .then(res => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(res.data, 'text/html');
                const items = Array.from(doc.querySelectorAll('.card')).map(card => ({
                  name: card.querySelector('.name').textContent,
                  price: parseInt(card.querySelector('.price').textContent.replace('₹','')),
                  image: card.querySelector('img').src,
                  sizes: card.querySelector('div[style*="color"]').textContent.replace('Sizes: ','').split(', ')
                }));
                setProducts(items);
              });
          });
      }, []);

      const addToCart = (p) => {
        setCart([...cart, p]);
        alert(`${p.name} added to cart!`);
      };

      if (page === 'cart') return (
        <div className="cart-page">
          <h1>Your Cart ({cart.length})</h1>
          {cart.map((item,i)=>(
            <div key={i} style={{padding:'20px',borderBottom:'1px solid #ddd',display:'flex',justifyContent:'space-between',fontSize:'20px'}}>
              <span>{item.name}</span>
              <span>₹{item.price}</span>
            </div>
          ))}
          <h2 style={{margin:'40px 0',textAlign:'right'}}>Total: ₹{cart.reduce((a,b)=>a+b.price,0)}</h2>
          <button className="checkout-btn" onClick={()=>setPage('success')}>Checkout Now</button>
        </div>
      );

      if (page === 'success') return (
        <div className="success">
          <h1>Order Placed Successfully!</h1>
          <p>Thank you for shopping with Clothify</p>
          <button className="checkout-btn" onClick={()=>{setCart([]);setPage('home')}}>Shop More</button>
        </div>
      );

      return (
        <>
          <header className="header">
            <div className="logo">Clothify</div>
            <button className="cart-btn" onClick={()=>setPage('cart')}>
              Cart ({cart.length})
            </button>
          </header>

          <div className="hero">
            <h1>Welcome to Clothify</h1>
            <p>Premium Clothing • Best Prices • Fast Delivery</p>
          </div>

          <div className="products">
            {products.map(p => (
              <div key={p._id || p.name} className="card">
                <img src={p.image} alt={p.name}/>
                <div className="info">
                  <h3>{p.name}</h3>
                  <p>Sizes: {p.sizes?.join(', ')}</p>
                  <div className="price">₹{p.price}</div>
                  <button className="add-btn" onClick={()=>addToCart(p)}>
                    Add to Cart
                  </button>
                </div>
              </div>
            ))}
          </div>
        </>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>